<?xml version="1.0"?>

<!--
  ~ Apache License
  ~ Version 2.0, January 2004
  ~ http://www.apache.org/licenses/
  ~
  ~ Copyright 2008 by chenillekit.org
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  -->

<project name="ck_rollout" default="main" basedir=".">

	<property name="work.dir" value="${basedir}/rollout"/>
	<property name="svn.url" value="http://chenillekit.googlecode.com/svn/trunk/"/>

	<!--
	checkout the latest repository trunk
	-->
	<target name="checkout">
		<exec executable="svn">
			<arg value="co"/>
			<arg value="${svn.url}"/>
			<arg value="${work.dir}"/>
			<arg value="--non-interactive"/>
		</exec>
	</target>

	<!--
	install our project skin for maven site
	-->
	<target name="install_skin">

		<echo message="install site skin into local maven repo, please wait ..."/>

		<exec executable="mvn" dir="${work.dir}/maven-skin" output="${work.dir}/install_skin.log">
			<arg value="clean"/>
			<arg value="install"/>
		</exec>
	</target>

	<!--
	compile pack an install all project modules
	-->
	<target name="install_modules">

		<echo message="install all modules into local maven repo, please wait ..."/>

		<exec executable="mvn" dir="${work.dir}" output="${work.dir}/install_modules.log">
			<arg value="-Dmaven.test.skip=true"/>
			<arg value="clean"/>
			<arg value="package"/>
			<arg value="install"/>
		</exec>
	</target>

	<!--
	create site
	-->
	<target name="create_site">

		<echo message="create project site, please wait ..."/>

		<exec executable="mvn" dir="${work.dir}" output="${work.dir}/create_site.log">
			<arg value="-Dmaven.test.skip=true"/>
			<arg value="site"/>
		</exec>
	</target>

	<!--
	deploy project into remote maven repo
	-->
	<target name="deploy_project">

		<echo message="deploy project into remote maven repo, please wait ..."/>

		<exec executable="mvn" dir="${work.dir}" output="${work.dir}/deploy_project.log">
			<arg value="-Dmaven.test.skip=true"/>
			<arg value="deploy"/>
		</exec>
	</target>

	<!--
	deploy project site
	-->
	<target name="deploy_site">

		<echo message="deploy project site, please wait ..."/>

		<exec executable="mvn" dir="${work.dir}" output="${work.dir}/deploy_site.log">
			<arg value="-Dmaven.test.skip=true"/>
			<arg value="site:deploy"/>
		</exec>
	</target>

	<target name="main">

		<!--<antcall target="checkout"/>-->
		<!--<antcall target="install_skin"/>-->
		<!--<antcall target="install_modules"/>-->
		<!--<antcall target="create_site"/>-->
		<!--<antcall target="deploy_project"/>-->
		<antcall target="deploy_site"/>

	</target>

</project>
